import hashlib
import random
import math

def simple_hash(text):
    """
    –ü—Ä–æ—Å—Ç–∞—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è —á–∏—Å–ª–æ
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
    –≠—Ç–æ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è —Å –æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º 31.
    –î–ª—è —Å—Ç—Ä–æ–∫–∏ s = s‚ÇÄs‚ÇÅs‚ÇÇ...s‚Çô‚Çã‚ÇÅ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è:
    h(s) = s‚ÇÄ√ó31^(n-1) + s‚ÇÅ√ó31^(n-2) + ... + s‚Çô‚Çã‚ÇÅ√ó31^0
    
    –ü–æ—á–µ–º—É 31?
    - 31 –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ, —á—Ç–æ —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–ª–∏–∑–∏–∏
    - 31 = 32 - 1, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É–º–Ω–æ–∂–µ–Ω–∏–µ
    - –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ –¥–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –¥–∞–µ—Ç —Ö–æ—Ä–æ—à–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    
    –°–≤–æ–π—Å—Ç–≤–∞:
    - –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∞: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤—Ö–æ–¥ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤—ã—Ö–æ–¥
    - –£—á–∏—Ç—ã–≤–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤: "AB" ‚â† "BA"
    - –ë—ã—Å—Ç—Ä–∞—è –≤—ã—á–∏—Å–ª–∏–º–æ—Å—Ç—å: O(n) –≤—Ä–µ–º–µ–Ω–∏
    """
    hash_value = 0
    for char in text:
        hash_value = hash_value * 31 + ord(char)
    return hash_value

def better_hash(text):
    """
    –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SHA-256
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
    SHA-256 –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö:
    1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ XOR, —Å–¥–≤–∏–≥–∏, –º–æ–¥—É–ª—å–Ω–æ–µ —Å–ª–æ–∂–µ–Ω–∏–µ
    2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç 64 —Ä–∞—É–Ω–¥–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏
    3. –ö–∞–∂–¥—ã–π –±–∏—Ç –≤—ã—Ö–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞–∂–¥–æ–≥–æ –±–∏—Ç–∞ –≤—Ö–æ–¥–∞
    
    –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:
    - –û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–æ—Å—Ç—å: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ x –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ h(x)
    - –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∫–æ–ª–ª–∏–∑–∏—è–º: —Å–ª–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ x‚ÇÅ ‚â† x‚ÇÇ –≥–¥–µ h(x‚ÇÅ) = h(x‚ÇÇ)
    - –≠—Ñ—Ñ–µ–∫—Ç –ª–∞–≤–∏–Ω—ã: –∏–∑–º–µ–Ω–µ–Ω–∏–µ 1 –±–∏—Ç–∞ –≤—Ö–æ–¥–∞ –º–µ–Ω—è–µ—Ç ~50% –±–∏—Ç–æ–≤ –≤—ã—Ö–æ–¥–∞
    - –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ö—ç—à–∞ —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω—ã
    
    –ü–æ—á–µ–º—É –±–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤:
    - –ü–æ–ª–Ω—ã–π SHA-256 –¥–∞–µ—Ç 256 –±–∏—Ç (64 hex —Å–∏–º–≤–æ–ª–∞)
    - 8 hex —Å–∏–º–≤–æ–ª–æ–≤ = 32 –±–∏—Ç–∞ = 4,294,967,296 –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –Ω–æ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
    """
    sha256_hash = hashlib.sha256(text.encode()).hexdigest()
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –ø–µ—Ä–≤—ã–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ hex –≤ —á–∏—Å–ª–æ
    return int(sha256_hash[:8], 16)

def gcd(a, b):
    """
    –ê–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ù–û–î
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
    –¢–µ–æ—Ä–µ–º–∞: gcd(a, b) = gcd(b, a mod b)
    
    –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:
    –ü—É—Å—Ç—å d = gcd(a, b) –∏ d' = gcd(b, a mod b)
    
    1) a = bq + r, –≥–¥–µ r = a mod b
    2) –õ—é–±–æ–π –æ–±—â–∏–π –¥–µ–ª–∏—Ç–µ–ª—å a –∏ b —Ç–∞–∫–∂–µ –¥–µ–ª–∏—Ç r = a - bq
    3) –õ—é–±–æ–π –æ–±—â–∏–π –¥–µ–ª–∏—Ç–µ–ª—å b –∏ r —Ç–∞–∫–∂–µ –¥–µ–ª–∏—Ç a = bq + r
    4) –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –æ–±—â–∏—Ö –¥–µ–ª–∏—Ç–µ–ª–µ–π (a,b) –∏ (b,r) —Å–æ–≤–ø–∞–¥–∞—é—Ç
    5) –ó–Ω–∞—á–∏—Ç, –∏—Ö –Ω–∞–∏–±–æ–ª—å—à–∏–µ –æ–±—â–∏–µ –¥–µ–ª–∏—Ç–µ–ª–∏ —Ä–∞–≤–Ω—ã: d = d'
    
    –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(log(min(a, b))) - –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –¥–∞–∂–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª
    
    –ü—Ä–∏–º–µ—Ä:
    gcd(48, 18):
    48 = 18√ó2 + 12  ‚Üí  gcd(18, 12)
    18 = 12√ó1 + 6   ‚Üí  gcd(12, 6)
    12 = 6√ó2 + 0    ‚Üí  gcd(6, 0) = 6
    """
    while b:
        a, b = b, a % b
    return a

def mod_inverse(e, phi):
    """
    –ù–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —á–∏—Å–ª–∞
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
    –ò—â–µ–º —á–∏—Å–ª–æ d —Ç–∞–∫–æ–µ, —á—Ç–æ: e √ó d ‚â° 1 (mod œÜ)
    
    –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞:
    –î–ª—è –ª—é–±—ã—Ö a, b —Å—É—â–µ—Å—Ç–≤—É—é—Ç x, y —Ç–∞–∫–∏–µ —á—Ç–æ: ax + by = gcd(a, b)
    
    –ï—Å–ª–∏ gcd(e, œÜ) = 1, —Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç x, y: ex + œÜy = 1
    –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç: ex ‚â° 1 (mod œÜ), –≥–¥–µ x –∏ –µ—Å—Ç—å –∏—Å–∫–æ–º–æ–µ d
    
    –ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ RSA:
    1) –í—ã–±–∏—Ä–∞–µ–º e –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ —Å œÜ(n) = (p-1)(q-1)
    2) –ù–∞—Ö–æ–¥–∏–º d = e‚Åª¬π (mod œÜ)
    3) –¢–æ–≥–¥–∞ ed ‚â° 1 (mod œÜ)
    4) –ü–æ —Ç–µ–æ—Ä–µ–º–µ –≠–π–ª–µ—Ä–∞: m^(ed) ‚â° m^1 ‚â° m (mod n)
    5) –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É
    
    –ü—Ä–∏–º–µ—Ä:
    e = 3, œÜ = 40
    –ò—â–µ–º d: 3d ‚â° 1 (mod 40)
    –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ï–≤–∫–ª–∏–¥: 3√ó27 + 40√ó(-2) = 1
    –ó–Ω–∞—á–∏—Ç d = 27, –ø—Ä–æ–≤–µ—Ä–∫–∞: 3√ó27 = 81 ‚â° 1 (mod 40) ‚úì
    """
    def extended_gcd(a, b):
        if a == 0:
            return b, 0, 1
        gcd, x1, y1 = extended_gcd(b % a, a)
        x = y1 - (b // a) * x1
        y = x1
        return gcd, x, y
    
    gcd, x, _ = extended_gcd(e, phi)
    if gcd != 1:
        raise ValueError("–ú–æ–¥—É–ª—å–Ω–æ–µ –æ–±—Ä–∞—Ç–Ω–æ–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
    return (x % phi + phi) % phi

def is_prime(n):
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç—É (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º)
    
    –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:
    –¢–µ–æ—Ä–µ–º–∞: –ï—Å–ª–∏ n —Å–æ—Å—Ç–∞–≤–Ω–æ–µ, —Ç–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –¥–µ–ª–∏—Ç–µ–ª—å ‚â§ ‚àön
    
    –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:
    –ü—É—Å—Ç—å n = a √ó b, –≥–¥–µ a, b > 1
    –ï—Å–ª–∏ a > ‚àön –∏ b > ‚àön, —Ç–æ a √ó b > ‚àön √ó ‚àön = n
    –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ! –ó–Ω–∞—á–∏—Ç, —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –¥–µ–ª–∏—Ç–µ–ª–µ–π ‚â§ ‚àön
    
    –ê–ª–≥–æ—Ä–∏—Ç–º:
    1) –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —á–∏—Å–ª–∞ –æ—Ç 2 –¥–æ ‚àön
    2) –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –¥–µ–ª–∏—Ç–µ–ª—å - —á–∏—Å–ª–æ —Å–æ—Å—Ç–∞–≤–Ω–æ–µ
    3) –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ - —á–∏—Å–ª–æ –ø—Ä–æ—Å—Ç–æ–µ
    
    –°–ª–æ–∂–Ω–æ—Å—Ç—å: O(‚àön) - –¥–ª—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ —Ç–æ—á–Ω–æ
    
    –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å):
    - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ 2, –ø–æ—Ç–æ–º –Ω–µ—á–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞
    - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ –¥–µ–ª–∏—Ç–µ–ª–∏ (—Ä–µ—à–µ—Ç–æ –≠—Ä–∞—Ç–æ—Å—Ñ–µ–Ω–∞)
    - –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ú–∏–ª–ª–µ—Ä-–†–∞–±–∏–Ω) –¥–ª—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª
    
    –ü—Ä–∏–º–µ—Ä—ã:
    n = 17: –ø—Ä–æ–≤–µ—Ä—è–µ–º 2,3,4 (–¥–æ ‚àö17 ‚âà 4.1) - –¥–µ–ª–∏—Ç–µ–ª–µ–π –Ω–µ—Ç ‚Üí –ø—Ä–æ—Å—Ç–æ–µ
    n = 15: –ø—Ä–æ–≤–µ—Ä—è–µ–º 2,3 - –Ω–∞—Ö–æ–¥–∏–º 3 ‚Üí —Å–æ—Å—Ç–∞–≤–Ω–æ–µ (15 = 3√ó5)
    """
    if n < 2:
        return False
    for i in range(2, int(n**0.5) + 1):
        if n % i == 0:
            return False
    return True

def generate_prime(min_val, max_val):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ"""
    while True:
        num = random.randint(min_val, max_val)
        if is_prime(num):
            return num

def generate_rsa_keys():
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã RSA –∫–ª—é—á–µ–π"""
    # –í—ã–±–∏—Ä–∞–µ–º –¥–≤–∞ –ø—Ä–æ—Å—Ç—ã—Ö —á–∏—Å–ª–∞ (–º–∞–ª–µ–Ω—å–∫–∏–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏)
    p = generate_prime(50, 100)
    q = generate_prime(50, 100)
    
    # –í—ã—á–∏—Å–ª—è–µ–º n –∏ —Ñ—É–Ω–∫—Ü–∏—é –≠–π–ª–µ—Ä–∞
    n = p * q
    phi = (p - 1) * (q - 1)
    
    # –í—ã–±–∏—Ä–∞–µ–º e (–Ω–∞—á–∏–Ω–∞–µ–º —Å –Ω–µ–±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
    e = 3
    while gcd(e, phi) != 1:
        e += 2  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞ 2, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–µ—á–µ—Ç–Ω—ã–º
    
    # –í—ã—á–∏—Å–ª—è–µ–º d
    d = mod_inverse(e, phi)
    
    public_key = (e, n)
    private_key = (d, n)
    
    return public_key, private_key, p, q

def rsa_encrypt(message, public_key):
    """–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞"""
    e, n = public_key
    # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∏—Å–ª–æ
    if isinstance(message, str):
        message_num = sum(ord(c) for c in message) % (n - 1) + 1
    else:
        message_num = message % (n - 1) + 1
    
    encrypted = pow(message_num, e, n)
    return encrypted, message_num

def rsa_decrypt(encrypted_message, private_key):
    """–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞"""
    d, n = private_key
    decrypted = pow(encrypted_message, d, n)
    return decrypted

def create_digital_signature(message, private_key):
    """–°–æ–∑–¥–∞–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏"""
    # –°–Ω–∞—á–∞–ª–∞ —Ö—ç—à–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    message_hash = better_hash(message)
    d, n = private_key
    
    # –ü—Ä–∏–≤–æ–¥–∏–º —Ö—ç—à –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [1, n-1]
    message_hash = message_hash % (n - 1) + 1
    
    # –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º —Ö—ç—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º
    signature = pow(message_hash, d, n)
    return signature, message_hash

def verify_signature(message, signature, public_key):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏"""
    # –•—ç—à–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    message_hash = better_hash(message)
    e, n = public_key
    
    # –ü—Ä–∏–≤–æ–¥–∏–º —Ö—ç—à –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [1, n-1]
    message_hash = message_hash % (n - 1) + 1
    
    # –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ–º –ø–æ–¥–ø–∏—Å—å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º
    decrypted_hash = pow(signature, e, n)
    
    # –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ö—ç—à–∏
    return message_hash == decrypted_hash, message_hash, decrypted_hash

def demonstrate_crypto():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π"""
    print("=== –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏–π ===")
    text = "–ü—Ä–∏–≤–µ—Ç, –±–ª–æ–∫—á–µ–π–Ω!"
    print(f"–¢–µ–∫—Å—Ç: {text}")
    print(f"–ü—Ä–æ—Å—Ç–æ–π —Ö—ç—à: {simple_hash(text)}")
    print(f"SHA-256 —Ö—ç—à: {better_hash(text)}")
    
    print("\n=== –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è RSA —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è ===")
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–∏
    public_key, private_key, p, q = generate_rsa_keys()
    print(f"–ü—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ p={p}, q={q}")
    print(f"n = p * q = {p * q}")
    print(f"–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (e, n): {public_key}")
    print(f"–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (d, n): {private_key}")
    
    # –®–∏—Ñ—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    message = "–°–µ–∫—Ä–µ—Ç"
    print(f"\n–ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: {message}")
    
    encrypted, original_num = rsa_encrypt(message, public_key)
    print(f"–°–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ —á–∏—Å–ª–æ: {original_num}")
    print(f"–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: {encrypted}")
    
    decrypted = rsa_decrypt(encrypted, private_key)
    print(f"–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (—á–∏—Å–ª–æ): {decrypted}")
    print(f"–ü—Ä–æ–≤–µ—Ä–∫–∞: {original_num == decrypted}")
    
    print("\n=== –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ ===")
    
    # –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∏—Å—å
    signature, hash_value = create_digital_signature(message, private_key)
    print(f"–•—ç—à —Å–æ–æ–±—â–µ–Ω–∏—è: {hash_value}")
    print(f"–¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å: {signature}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–ø–∏—Å—å
    is_valid, original_hash, decrypted_hash = verify_signature(message, signature, public_key)
    print(f"–ò—Å—Ö–æ–¥–Ω—ã–π —Ö—ç—à: {original_hash}")
    print(f"–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—ç—à: {decrypted_hash}")
    print(f"–ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞: {is_valid}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
    fake_message = "–ü–æ–¥–¥–µ–ª—å–Ω–æ–µ"
    is_fake_valid, fake_hash, _ = verify_signature(fake_message, signature, public_key)
    print(f"\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è '{fake_message}':")
    print(f"–•—ç—à –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: {fake_hash}")
    print(f"–ü–æ–¥–ø–∏—Å—å –¥–ª—è –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω–∞: {is_fake_valid}")

def interactive_hash_task():
    """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ"""
    print("\n" + "="*50)
    print("–ó–ê–î–ê–ù–ò–ï 1: –•—ç—à-—Ñ—É–Ω–∫—Ü–∏–∏")
    print("="*50)
    
    print("–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!")
    
    while True:
        user_input = input("\n–í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (–∏–ª–∏ 'exit' –¥–ª—è –≤—ã—Ö–æ–¥–∞): ")
        if user_input.lower() == 'exit':
            break
            
        simple = simple_hash(user_input)
        better = better_hash(user_input)
        
        print(f"–ü—Ä–æ—Å—Ç–æ–π —Ö—ç—à: {simple}")
        print(f"SHA-256 —Ö—ç—à: {better}")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —Ö—ç—à –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω
        print(f"–ü–æ–≤—Ç–æ—Ä–Ω—ã–π SHA-256 —Ö—ç—à: {better_hash(user_input)}")
        print("–ó–∞–º–µ—Ç–∏–ª–∏? –•—ç—à –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏!")

def interactive_rsa_task():
    """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ RSA"""
    print("\n" + "="*50)
    print("–ó–ê–î–ê–ù–ò–ï 2: RSA –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ")
    print("="*50)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–∏
    public_key, private_key, p, q = generate_rsa_keys()
    
    print("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã RSA –∫–ª—é—á–∏:")
    print(f"p = {p}, q = {q}")
    print(f"n = {p * q}")
    print(f"–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á: {public_key}")
    print(f"–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á: {private_key}")
    
    while True:
        message = input("\n–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–∏–ª–∏ 'exit' –¥–ª—è –≤—ã—Ö–æ–¥–∞): ")
        if message.lower() == 'exit':
            break
            
        try:
            encrypted, original_num = rsa_encrypt(message, public_key)
            decrypted = rsa_decrypt(encrypted, private_key)
            
            print(f"–ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: '{message}'")
            print(f"–ö–∞–∫ —á–∏—Å–ª–æ: {original_num}")
            print(f"–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ: {encrypted}")
            print(f"–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ: {decrypted}")
            print(f"–ü—Ä–æ–≤–µ—Ä–∫–∞: {original_num == decrypted}")
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞: {e}")

def quiz():
    """–ö–≤–∏–∑ –ø–æ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏"""
    print("\n" + "="*50)
    print("–ö–í–ò–ó: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è!")
    print("="*50)
    
    questions = [
        {
            "question": "–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø–µ—Ä–µ–¥ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º?",
            "options": ["1. –•—ç—à –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è", "2. –•—ç—à –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è", "3. –•—ç—à –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ"],
            "correct": 2,
            "explanation": "–≠—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è '—ç—Ñ—Ñ–µ–∫—Ç –ª–∞–≤–∏–Ω—ã' - –º–∞–ª–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—Ö–æ–¥–∞ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é –≤—ã—Ö–æ–¥–∞"
        },
        {
            "question": "–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏?",
            "options": ["1. –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á", "2. –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á", "3. –û–±–∞ –∫–ª—é—á–∞"],
            "correct": 2,
            "explanation": "–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ - –ø—É–±–ª–∏—á–Ω—ã–π"
        },
        {
            "question": "–ú–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –µ–≥–æ —Ö—ç—à–∞?",
            "options": ["1. –î–∞, –≤—Å–µ–≥–¥–∞", "2. –ù–µ—Ç, —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ", "3. –ò–Ω–æ–≥–¥–∞"],
            "correct": 2,
            "explanation": "–•—ç—à-—Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω—É —Å—Ç–æ—Ä–æ–Ω—É - —ç—Ç–æ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è"
        }
    ]
    
    score = 0
    for i, q in enumerate(questions, 1):
        print(f"\n–í–æ–ø—Ä–æ—Å {i}: {q['question']}")
        for option in q['options']:
            print(option)
        
        while True:
            try:
                answer = int(input("–í–∞—à –æ—Ç–≤–µ—Ç (1, 2 –∏–ª–∏ 3): "))
                if answer in [1, 2, 3]:
                    break
                else:
                    print("–í–≤–µ–¥–∏—Ç–µ 1, 2 –∏–ª–∏ 3")
            except ValueError:
                print("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ!")
        
        if answer == q['correct']:
            print("‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!")
            score += 1
        else:
            print("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.")
        
        print(f"–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: {q['explanation']}")
    
    print(f"\n–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {score}/{len(questions)}")
    if score == len(questions):
        print("üéâ –û—Ç–ª–∏—á–Ω–æ! –í—ã —Ä–∞–∑–±–∏—Ä–∞–µ—Ç–µ—Å—å –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏!")
    elif score >= len(questions) // 2:
        print("üëç –ù–µ–ø–ª–æ—Ö–æ! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–∑—É—á–∞—Ç—å!")
    else:
        print("üìö –°—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª!")

if __name__ == "__main__":
    print("üîê –î–û–ë–†–û –ü–û–ñ–ê–õ–û–í–ê–¢–¨ –í –ú–ò–† –ö–†–ò–ü–¢–û–ì–†–ê–§–ò–ò! üîê")
    print("\n–°–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é:")
    
    demonstrate_crypto()
    
    print("\n–¢–µ–ø–µ—Ä—å –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏!")
    
    # –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
    interactive_hash_task()
    interactive_rsa_task()
    quiz()
    
    print("\nüéì –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –∏–∑—É—á–∏–ª–∏ –æ—Å–Ω–æ–≤—ã –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏!")
    print("–ü–æ–º–Ω–∏—Ç–µ: –≤ —Ä–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∏ –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞!")